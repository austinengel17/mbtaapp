{"ast":null,"code":"import { useState, useEffect } from \"react\";\nimport * as d3 from \"d3\";\nvar backendHost = \"localhost:8080/\";\nvar controllerEndpoint = \"mbta/v1/livemap\";\nvar vehiclePositionSub = \"/vehicle/location/Green-E\";\nvar mbtaStopsEndpoint = \"/stops/line/Green-E\";\nfunction Draw() {\n  var xhr = new XMLHttpRequest();\n\n  // Making our connection \n  var url = \"http://\" + backendHost + controllerEndpoint + mbtaStopsEndpoint;\n  xhr.open(\"GET\", url, true);\n\n  // function execute after request is successful\n  xhr.onreadystatechange = function () {\n    if (this.readyState == 4 && this.status == 200) {\n      console.log(JSON.parse(this.responseText));\n      var splitStationLocation;\n      var temp = JSON.parse(this.responseText);\n      var stationData = Object.keys(temp).map(v => ({\n        [v.replace(/['\"]+/g, '')]: {\n          ...temp[v]\n        }\n      }));\n      var lineYAxis = 150;\n      console.log(stationData);\n      var svg = d3.select(\"svg\");\n      var stopGroup = svg.selectAll(\"g\").data(stationData).enter().append(\"g\").attr(\"transform\", function (d, i) {\n        return \"translate(\" + (30 + i * 40) + \", \" + lineYAxis + \")\";\n      });\n      stopGroup.append(\"circle\").attr(\"cx\", 0).attr(\"cy\", 0).attr(\"r\", 2).attr(\"fill\", \"red\").attr(\"class\", d => Object.keys(d)[0]);\n      stopGroup.append(\"text\").text(function (d) {\n        return d[Object.keys(d)[0]].name;\n      }).attr(\"width\", 100).attr(\"x\", 0) // Set the x-coordinate\n      .attr(\"y\", -10).attr(\"text-anchor\", \"middle\").attr(\"font-size\", 5);\n      var stops = svg.selectAll(\"circle\");\n      stopGroup.each(function (d) {\n        var circle = d3.select(this).select(\"circle\");\n        var circleNode = circle.node();\n        var circlePosition = circleNode.getBoundingClientRect();\n        console.log(\"Circle absolute position:\", circlePosition);\n      });\n\n      // stops.each(function(d){\n      //   var stop = d3.select(this);\n      //   console.log(stop);\n      //   svg.append(\"line\")\n      //   .attr(\"x\", +stop.attr(\"cx\"))\n      //   .attr(\"y\", +stop.attr(\"cy\"))\n      //   .attr(\"stroke\", \"green\")\n      //   .attr(\"stroke-width\", 1);\n      // });\n    }\n    // appendRouteLines();\n  };\n\n  xhr.onerror = function (error) {\n    console.error(error);\n  };\n  xhr.send();\n  console.log(\"sent\");\n}\n\n// function appendRouteLines(){\n//     var stops = svg.selectAll(\"g\");\n\n// }\n_c = Draw;\nexport default Draw;\nvar _c;\n$RefreshReg$(_c, \"Draw\");","map":{"version":3,"names":["useState","useEffect","d3","backendHost","controllerEndpoint","vehiclePositionSub","mbtaStopsEndpoint","Draw","xhr","XMLHttpRequest","url","open","onreadystatechange","readyState","status","console","log","JSON","parse","responseText","splitStationLocation","temp","stationData","Object","keys","map","v","replace","lineYAxis","svg","select","stopGroup","selectAll","data","enter","append","attr","d","i","text","name","stops","each","circle","circleNode","node","circlePosition","getBoundingClientRect","onerror","error","send","_c","$RefreshReg$"],"sources":["/Users/austin/Dev Projects/mbtaapp/mbta-frontend/src/draw.js"],"sourcesContent":["import { useState, useEffect } from \"react\";\nimport * as d3 from \"d3\";\n\n\n\nvar backendHost = \"localhost:8080/\";\nvar controllerEndpoint = \"mbta/v1/livemap\";\nvar vehiclePositionSub = \"/vehicle/location/Green-E\";\nvar mbtaStopsEndpoint = \"/stops/line/Green-E\";\nfunction Draw() {\n   var xhr = new XMLHttpRequest();\n \n    // Making our connection \n    var url = \"http://\" + backendHost + controllerEndpoint + mbtaStopsEndpoint;\n    xhr.open(\"GET\", url, true);\n \n    // function execute after request is successful\n    xhr.onreadystatechange = function () {\n        if (this.readyState == 4 && this.status == 200) {\n            console.log(JSON.parse(this.responseText));\n            var splitStationLocation;\n            var temp = JSON.parse(this.responseText);\n            var stationData = Object.keys(temp).map(v => ({[v.replace(/['\"]+/g, '')]: {...temp[v]}}));\n            var lineYAxis = 150;\n            console.log(stationData);\n            var svg = d3.select(\"svg\");\n            var stopGroup = svg.selectAll(\"g\")\n            .data(stationData)\n            .enter()\n            .append(\"g\")\n            .attr(\"transform\", function(d, i) {\n                return \"translate(\" + (30 + i * 40) + \", \" + (lineYAxis) + \")\";\n            });\n            stopGroup.append(\"circle\")\n              .attr(\"cx\", 0)\n              .attr(\"cy\", 0)\n              .attr(\"r\", 2)\n              .attr(\"fill\", \"red\")\n              .attr(\"class\", d=>Object.keys(d)[0]);\n\n             stopGroup.append(\"text\")\n                .text(function(d) {\n                  return d[Object.keys(d)[0]].name;})\n                .attr(\"width\", 100)\n                .attr(\"x\", 0) // Set the x-coordinate\n                .attr(\"y\", -10)\n                .attr(\"text-anchor\", \"middle\")\n                .attr(\"font-size\", 5);\n            var stops = svg.selectAll(\"circle\");\n             \n            stopGroup.each(function(d) {\n  var circle = d3.select(this).select(\"circle\");\n\n  var circleNode = circle.node();\n  var circlePosition = circleNode.getBoundingClientRect();\n\n  console.log(\"Circle absolute position:\", circlePosition);\n});\n\n\n             \n            // stops.each(function(d){\n            //   var stop = d3.select(this);\n            //   console.log(stop);\n            //   svg.append(\"line\")\n            //   .attr(\"x\", +stop.attr(\"cx\"))\n            //   .attr(\"y\", +stop.attr(\"cy\"))\n            //   .attr(\"stroke\", \"green\")\n            //   .attr(\"stroke-width\", 1);\n            // });\n        }\n        // appendRouteLines();\n      };\n    xhr.onerror = function (error){\n      console.error(error);\n    };\n    xhr.send();\n    console.log(\"sent\");\n}\n\n// function appendRouteLines(){\n//     var stops = svg.selectAll(\"g\");\n      \n// }\n\nexport default Draw;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}